<!DOCTYPE html>
<html lang="es">


<!--- REPOSITORIO DE IMÁGENES: https://unsplash.com/s/photos/product-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Online</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,200,0,200&" />
        
    <style>
        header, body{
                padding-top: 50px;
            }
            h1,h2,h3{
                text-align: center;
            }
    
            button{
                display:inline;
            }

            img{
                max-height: 150px;
                object-fit: cover;
            }

           
    </style>
    

</head>


<header class="bg-light border-bottom shadow-sm py-3 mb-4">
    <div class="container text-center">
        <h1 class="display-4 text-dark fw-bold">Im-personal Store</h1>
        <p class="lead text-muted">La tienda online para la gente que no tiene personalidad pero se cree "aesthetic"</p>
    </div>
</header>

<body >
    <div class="container" id="layout-1">
    
        <!-- Aquí se mostrarán los productos de la tienda -->
        <div class="row">
            <div class="col-md-8">
                <div class="row">

                    <div class="col-sm-6 col-md-6 col-lg-4 mb-2" >
                        <div class="card" >
                            <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cHJvZHVjdHxlbnwwfHwwfHx8MA%3D%3D" class="card-img-top" alt="Imagen del producto">
                            <div class="card-body" id="card-1">
                                <h5 class="card-title" id="nombre">Reloj </h5>
                                <p class="card-text"> Precio: <span id="precio">150.00</span>€ </p>
                                <input type="number" class="form-control form-control-sm mb-2" id="cantidad" value="1" min="1"/>
                                <button class="btn btn-primary" onclick="agregarAlCarrito(this)" id="agregarAlCarrito">Añadir al carrito</button>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-md-6 col-lg-4 mb-2" >
                        <div class="card">
                            <img src="https://images.unsplash.com/photo-1503602642458-232111445657?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8cHJvZHVjdHxlbnwwfHwwfHx8MA%3D%3D" class="card-img-top" alt="Imagen del producto">
                            <div class="card-body" id="card-1">
                                <h5 class="card-title" id="nombre">Taburete </h5>
                                <p class="card-text"> Precio: <span id="precio">25.00</span>€ </p>
                                <input type="number" class="form-control form-control-sm mb-2" id="cantidad" value="1" min="1"/>
                                <button class="btn btn-primary" onclick="agregarAlCarrito(this)" id="agregarAlCarrito">Añadir al carrito</button>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-md-6 col-lg-4 mb-2" >
                        <div class="card">
                            <img src="https://images.unsplash.com/photo-1504274066651-8d31a536b11a?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D" class="card-img-top" alt="Imagen del producto">
                            <div class="card-body" id="card-1">
                                <h5 class="card-title" id="nombre">Auriculares</h5>
                                <p class="card-text"> Precio: <span id="precio">28.00</span>€ </p>
                                <input type="number" class="form-control form-control-sm mb-2" id="cantidad" value="1" min="1"/>
                                <button class="btn btn-primary" onclick="agregarAlCarrito(this)" id="agregarAlCarrito">Añadir al carrito</button>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-md-6 col-lg-4 mb-2" >
                        <div class="card">
                            <img src="https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MzV8fHByb2R1Y3R8ZW58MHx8MHx8fDA%3D" class="card-img-top" alt="Imagen del producto">
                            <div class="card-body" id="card-1">
                                <h5 class="card-title" id="nombre">Gafas </h5>
                                <p class="card-text"> Precio: <span id="precio">80.00</span>€ </p>
                                <input type="number" class="form-control form-control-sm mb-2" id="cantidad" value="1" min="1"/>
                                <button class="btn btn-primary" onclick="agregarAlCarrito(this)" id="agregarAlCarrito">Añadir al carrito</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Aquí se mostrará el carrito (3 últimas columnas) -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3>Carrito</h3>
                    </div>
                    <div class="card-body">
                        <!---DIV vacío para mostrar datos del producto -->
                        <div id="datosProducto">
                            <h5>Código: ${index + 1}</h5>
                            <p>Nombre: ${dato.nombre}</p>
                            <p>Cantidad: ${dato.cantidad}</p>
                            <p>Precio: ${dato.precio}</p>
                            <hr>
                        </div>
                        <ul id="carrito"></ul>
                        <p>Total: 
                            <span id="cantidadTotal"></span> €
                        </p>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-success" onclick="comprarAhora()" id="comprarAhora">
                            <span class="material-symbols-outlined">
                                shopping_cart
                            </span>
                        </button>

                        <button class="btn btn-danger" onclick="eliminarProducto()" id="eliminarProducto">
                            <span class="material-symbols-outlined">
                                delete
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
  
    </div>

    <div class="container text-center py-5" id="layout-2" style="display: none;">
        <h3 class="display-4 text-success mb-4">Gracias por tu compra</h1>
        <p class="lead" id="texto-confirmacion">Tu pedido ha sido procesado con éxito. Esperamos verte de nuevo pronto.</p>
        <button class="btn btn-primary btn-lg mt-3" onclick="seguirComprando()">Seguir comprando</button>
    </div>
    
</body>  


    
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Métodos para el carrito de compras

    var buttonAdd = document.getElementById("agregarAlCarrito");
    var buttonBuy = document.getElementById("comprarAhora");
    var buttonDelete = document.getElementById("eliminarProducto");

    var listaCarrito = [];

    function agregarAlCarrito(boton) {
        let parentElement = boton.parentElement;

        let nombreProducto = parentElement.querySelector("#nombre").textContent;
        let cantidadProducto = parentElement.querySelector("#cantidad").value;
        let precioProducto = parentElement.querySelector("#precio").textContent;


        if (cantidadProducto <= 0) {
            alert("La cantidad debe ser mayor a 0");
            return;
        }
        
        let productoExistente = false;
        for (let item of listaCarrito) {
            if (item.nombre === nombreProducto) {
                console.log("Ya existe el producto en el carrito");
                item.cantidad = parseInt(item.cantidad) + parseInt(cantidadProducto);
                productoExistente = true;
                break; // Detiene la búsqueda si encuentra el producto
            }
        }

        if (!productoExistente) {
        let producto = {
            nombre: nombreProducto,
            cantidad: cantidadProducto,
            precio: precioProducto
        };
        listaCarrito.push(producto);
    }
        mostrarDatosProducto();
        sumarTotal();
        
    }


    function mostrarDatosProducto() {
        const contenedor = document.getElementById('datosProducto');
        contenedor.innerHTML = ""; // Limpiar contenido previo

        listaCarrito.forEach((dato, index) => {
            contenedor.innerHTML += `
                <h5>${index + 1} . ${dato.nombre} </h3>

                <p>Unidades: </p>
                <input type="number" class="form-control form-control-sm mb-2" id="cantidad" value="${dato.cantidad}" min="1" onclick="actualizarPrecio(this)"/>
                
                Precio: <p id="precio">${dato.precio}</p>
                <hr>
            `;
        });
        
    }

    function actualizarPrecio(inputField){
        console.log(inputField.value);
        let parentElement = inputField.parentElement;
        let nuevaCantidad = parseFloat(inputField.value);
        let precioUnitario = parseFloat(parentElement.querySelector("#precio").textContent);
        let valorTotal = nuevaCantidad * precioUnitario;
        console.log(valorTotal);
    }

    function sumarTotal() {
        const totalSpan = document.getElementById('cantidadTotal'); 
        let total = 0;
        let totalCantidadProductos = 0;
        listaCarrito.forEach((dato) => {
            total +=  parseFloat(dato.precio) * parseInt(dato.cantidad);
            totalCantidadProductos += parseInt(dato.cantidad);
        });
        totalSpan.textContent = total;
        return {
            totalDinero: total,
            totalCantidadProductos: totalCantidadProductos
        };
    }

    function comprarAhora() {
        let totales = sumarTotal();

        const layout1 = document.getElementById('layout-1');
        const layout2 = document.getElementById('layout-2');
        const textoConfirmacion = document.getElementById('texto-confirmacion');

        textoConfirmacion.textContent = `Tu pedido de ${totales.totalCantidadProductos} productos con un importe total de ${totales.totalDinero}€ se ha procesado con éxito .`;
 
        layout2.style.display = 'block';
        layout1.style.display = 'none';
    
        
    }

    function seguirComprando() {
        document.getElementById('layout-1').style.display = 'block';
        document.getElementById('layout-2').style.display = 'none';
    }

    function eliminarProducto() {
        // eliminamos el último producto
        listaCarrito.pop();
        mostrarDatosProducto()
    }

   

</script>




</html>